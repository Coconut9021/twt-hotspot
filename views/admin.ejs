<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/admin.css">
    <title>Wi-Fi Access Portal</title>
</head>
<body>
    <table id="clients">
        <tr>
            <th>Full name</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Company</th>
            <th>Terms</th>
            <th>Marketing</th>
            <th></th>
        </tr>
        <% data.forEach(row => { %>
            <tr>
                <td><%= row.fullName %></td>
                <td><%= row.email %></td>
                <td><%= row.phone %></td>
                <td><%= row.company %></td>
                <td><%= row.terms %></td>
                <td><%= row.marketing %></td>
                <td>
                    <div class="dropdown">
                        <div class="menu-btn">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="6" r="2" fill="#666666"/>
                                <circle cx="12" cy="12" r="2" fill="#666666"/>
                                <circle cx="12" cy="18" r="2" fill="#666666"/>
                            </svg>
                        </div>
                        <div class="dropdown-content">
                            <a href="#">Link 1</a>
                            <a href="#">Link 2</a>
                            <a data-bs-toggle="modal" data-bs-target="#staticBackdrop">Delete</a>
                        </div>

                        <!-- Deletion warning modal -->
                        <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="staticBackdropLabel">Are you sure you want to proceed</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <strong>Warning!</strong> You are about to permanently delete <strong><%= row.fullName %></strong>'s data.
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                <button type="button" class="btn btn-primary">Delete user</button>
                            </div>
                            </div>
                        </div>
                        </div>
                    </div>
                </td>
            </tr>
        <% }) %> 
    </table>



    <!-- Handles the dropdown menu -->
    <script>
        // Wait for DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            
            // Get all elements with class 'menu-btn dropdown'
            const menuBtns = document.querySelectorAll('.dropdown');

            menuBtns.forEach(dropdown => {
                const btn = dropdown.querySelector('.menu-btn');
                const dropdownContent = dropdown.querySelector('.dropdown-content');
                
                if (btn && dropdownContent) {
                    btn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        
                        // Close all other dropdowns first
                        document.querySelectorAll('.dropdown-content').forEach(content => {
                            if (content !== dropdownContent) {
                                content.style.display = 'none';
                            }
                        });
                        
                        // Toggle current dropdown
                        if (dropdownContent.style.display === 'block') {
                            dropdownContent.style.display = 'none';
                        } else {
                            dropdownContent.style.display = 'block';
                        }
                    });
                }
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function() {
                document.querySelectorAll('.dropdown-content').forEach(dropdown => {
                    dropdown.style.display = 'none';
                });
            });

            // Prevent dropdown from closing when clicking inside it
            document.querySelectorAll('.dropdown-content').forEach(dropdown => {
                dropdown.addEventListener('click', function(e) {
                    e.stopPropagation();
                });
            });
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>
</body>
</html>